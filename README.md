# FDK RDF Parser Service

This application parses RDF data to JSON.

For a broader understanding of the systemâ€™s context, refer to
the [architecture documentation](https://github.com/Informasjonsforvaltning/architecture-documentation) wiki. For more
specific context on this application, see the **Harvesting** subsystem section.

## Getting Started

These instructions will give you a copy of the project up and running on your local machine for development and testing
purposes.

### Prerequisites

- [pyenv](https://github.com/pyenv/pyenv) (recommended)
- [poetry](https://python-poetry.org/)
- [nox](https://nox.thea.codes/en/stable/)
- [nox-poetry](https://pypi.org/project/nox-poetry/)

### Running locally

#### Clone the repository

```bash
git clone https://github.com/Informasjonsforvaltning/fdk-rdf-parser-service.git
cd fdk-rdf-parser-service
```

#### Install software

```bash
pyenv install 3.13
pyenv local 3.13
pip install poetry==1.8.3
pip install nox==2024.4.15
pip install nox-poetry==1.0.3
poetry install
```

#### Start application

```bash
poetry run uvicorn fdk_rdf_parser_service.app:app --reload --port 8080 --env-file .env.development
```

#### Start application with Docker Compose

```bash
docker compose up -d
poetry shell
curl localhost:8080/ping
curl localhost:8080/ready
# Assuming you are in project root:
curl -X POST \
    --header "Content-Type: text/turtle" \
    --header "X-API-KEY: test-key" \
    --header "Accept: application/json" \
    --upload-file ./tests/data/dataset0.ttl \
    localhost:8080/dataset
```

### API Documentation (OpenAPI)

Generated by utility session in nox:

```bash
nox -s openapi
```

View in browser (when app is running locally) [localhost:8080/openapi.json](localhost:8080/openapi.json)

### Running tests

#### All tests

```bash
nox
```

#### Unit tests

```bash
nox -s unit_tests
```

#### Integration tests

```bash
nox -s integration_tests
```

#### Contract tests

```bash
nox -s contract_tests
```

#### Verbose mode

Verbose output from sessions for debugging

```bash
nox -s tests -- -vvv
```

### Other helpful commands

### Linter

```bash
nox -s lint
```

### Static type checking

```bash
nox -s mypy
```

#### Formatting

```bash
nox -s format
```

#### Clear py-cache

```bash
nox -s cache
```

#### Run tests outside of a nox session:

```bash
poetry run pytest
```

#### Run session with specified arguments:

```bash
nox -s tests -- -vv
```
