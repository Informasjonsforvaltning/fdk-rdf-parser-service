# fdk-rdf-parser-service

A Python service that parses RDF data to JSON.

## Developing

### Requirements

- [pyenv](https://github.com/pyenv/pyenv) (recommended)
- [poetry](https://python-poetry.org/)
- [nox](https://nox.thea.codes/en/stable/)
- [nox-poetry](https://pypi.org/project/nox-poetry/)

### Install software

```bash
pyenv install 3.11.8
pyenv local 3.11.8
pip install poetry==1.7.1
pip install nox==2024.3.2
pip install nox-poetry==1.0.3
poetry install
```

### Running the service locally

```bash
poetry run uvicorn fdk_rdf_parser_service.app:app --reload --port 8080 --env-file .env.development
```

### Running the service locally with docker

```bash
docker compose up -d
poetry shell
curl localhost:8080/ping
curl localhost:8080/ready
# Assuming you are in project root:
curl -X POST \
    --header "Content-Type: text/turtle" \
    --header "X-API-KEY: test-key" \
    --header "Accept: application/json" \
    --upload-file ./tests/data/dataset0.ttl \
    localhost:8080/dataset
```

### OpenAPI

Generated by utility session in nox:

```bash
nox -s openapi
```

View in browser (when app is running locally) [localhost:8080/openapi.json](localhost:8080/openapi.json)

## Testing

### Running tests

#### All tests

```bash
nox
```

#### Unit tests

```bash
nox -s unit_tests
```

#### Integration tests

```bash
nox -s integration_tests
```

#### Contract tests

```bash
nox -s contract_tests
```

#### Verbose mode

Verbose output from sessions for debugging

```bash
nox -s tests -- -vvv
```

### Other helpful commands

### Linter

```bash
nox -s lint
```

### Static type checking

```bash
nox -s mypy
```

#### Formatting

```bash
nox -s format
```

#### Clear py-cache

```bash
nox -s cache
```

#### Run tests outside of a nox session:

```bash
poetry run pytest
```

#### Run session with specified arguments:

```bash
nox -s tests -- -vv
```
